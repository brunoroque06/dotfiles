#!/usr/bin/env elvish

# @raycast.schemaVersion 1
# @raycast.title Pip Latest
# @raycast.mode compact
# @raycast.argument1 { "type": "text", "placeholder": "package" }

use re

var ver = (curl https://pypi.org/project/$args[0]/ ^
  | slurp ^
  | re:find '<p class="release__version">(?:\s*)(.*)(?:\s*)<\/p>' (one) ^
  | take 1 ^
  | put (one)[groups][1][text])

var pkg = $args[0]==$ver

print $pkg | pbcopy
put $pkg
